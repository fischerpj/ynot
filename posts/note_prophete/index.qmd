---
title: "Note Prophete"
author: "granPiero"
date: "2025-05-17"
categories: [code]
format: 
  html:
    include-in-header: "include-in-header.html"
    include-after-body: "after_body_editor.html"
    comments:
      utterances: 
        repo: "fischerpj/ynot"
execute:
  echo: false    
---

::: {#introDiv}
> This is a Global Note, using **EditorJS** and **localStorage** autosave mechanism.
>
> ui_elements.js creates the input bar.
>
> We have a div.editorjs area
:::

```{=html}
<script src="ui_elements.js" id="ui_structure type="application/javascript></script>
```

```{ojs}
import { Inputs } from "@observablehq/inputs";
import { html } from "@observablehq/stdlib";
import { Bcve, Ref } from "./BibleBooksCodes_Tables.js";

_STORAGE_KEY = "prophete";

//================== 1. INPUTS
// Editable input field
viewof RefInput = Inputs.text({
  label: "Search", 
  value: "ps42:1!KJV",
  style: "width: 150px;"
  })

// Inputs
/*viewof RefInput = html`<input type="text" 
//  class="form-control" 
  label= "Search" 
  style="width: 150px;"
  value="ps40"/>`;  
*/

//================== 2. ACCUMULATION
viewof RefAccu = Inputs.button("Keep", {
    value: JSON.parse(localStorage.getItem(_STORAGE_KEY)) || [],
    reduce: (list) => {
      const input = viewof RefInput.value;
      const validated = new Bcve(input);
      const result = validated.is_valid ? [validated.param, ...list ] : [...list]
      localStorage.setItem(_STORAGE_KEY, JSON.stringify(result));
      return result
  //    return [validated.param, ...list ]
      }
    });

dummy = { 
  viewof RefInput.classList.add("form-control");
  viewof RefAccu.classList.add("btn", "btn-warning");
}

// VIEWOF
html`<div class="button-row">
  ${viewof RefInput}
  ${viewof RefAccu}
  </div>`

//RefAccu;
```

```{ojs}
//================== INPUT PREVIEW
RefPreview = {
  const mb = new Bcve(RefInput);
  
  if (mb.is_valid) {
    const mir = new Ref(mb.param);
    await mir.fetch_parallel();   // Wait for data to be fetched
    await mir.data;
    await mir.displayData(); 
    return mir.outputContent;
  } else {
    return `<div><ul><li>${mb.param}</li></ul></div>`  
  }
}

html`${RefPreview}`

// Display the list
//html`<ul>${RefData.map(item => html`<li><strong>${item.ref}</strong> ${item.content} <em>${item.version}</em></li>`)}</ul>`
```

```{ojs}
//================== 3. FETCH

RefData = {
  // DATA is imported from BibleBooksCodes_Tables.js
//      const refArray =  RefAccu;
      const mir = new Ref(RefAccu);
      await mir.fetch_parallel();   // Wait for data to be fetched
//      await mir.displayData(); 
//      const displayContent = mir.outputContent;
//      return await mir
    return await mir.data
}

//RefData;

// Display the list
html`<ul>${RefData.map(item => html`<li><strong>${item.ref}</strong> ${item.content} <em>${item.version}</em></li>`)}</ul>`

```

```{=html}
<div id="inputDiv">this is inputDiv</div>
```

:::: {#outputDiv}
<div>

<!--  any output comes here to outputDiv is considered Void-->

</div>
::::

```{=html}
<div id="editorjs">this is editorDiv</div>
```

Jésus est plus grand que les prophètes.

Un prophète transmet les messages de Dieu, sur les sujets d'actualité ou d'avenir. Il est appelé voyant parce qu'il perçoit les réalités invisibles.
